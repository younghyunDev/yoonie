<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>🍽️ 윤이 뭐뭐 먹지?</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to bottom right, #fff9f0, #ffe0e0);
      color: #333;
      padding: 1rem;
      margin: 0;
    }
    h1 {
      text-align: center;
      font-size: 2.5rem;
      margin-bottom: 2rem;
      line-height: 1.2;
    }
    .tree {
      display: block;
      max-width: 800px;
      margin: 0 auto;
      padding: 1rem;
      background: #fff;
      border-radius: 1rem;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      position: relative;
    }
    .node {
      position: relative;
      padding-left: 2rem;
      margin-bottom: 1rem;
      transition: background-color 0.3s ease, opacity 0.5s ease;
    }
    .node::before {
      content: '📍';
      position: absolute;
      left: 0;
      top: 0;
    }
    .branch {
      margin-left: 1.5rem;
      border-left: 2px dashed #ccc;
      padding-left: 1rem;
      /* 하위 메뉴는 기본적으로 숨김 */
      display: none;
    }
    .branch.visible {
      /* 선택된 하위 메뉴를 표시 */
      display: block;
    }
    .choice-node {
      cursor: pointer;
      border-radius: 8px;
    }
    .choice-node:hover {
        background-color: #fdf5e6; /* 부드러운 호버 효과 */
    }
    .selected {
        background-color: #e0f7fa;
        font-weight: bold;
    }
    .unselected {
        opacity: 0.4;
        pointer-events: none; /* 클릭 비활성화 */
    }
    .action-button {
      display: block;
      margin: 2rem auto;
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      background-color: #ff9a9e;
      color: white;
      border: none;
      border-radius: 1rem;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }
    .action-button:hover {
      background-color: #ff6a6a;
      transform: scale(1.05);
    }
    .result {
      text-align: center;
      margin-top: 1.5rem;
      font-size: 1.5rem; /* 결과 텍스트 크기 증가 */
      font-weight: bold;
      color: #d6336c;
      min-height: 2rem;
    }
    .highlight {
      background-color: #fff3cd;
      border-radius: 4px;
    }
    .hidden {
        display: none;
    }
    @media (max-width: 600px) {
      h1 {
        font-size: 2rem;
      }
      .tree {
        padding: 0.5rem;
      }
      .node {
        font-size: 0.95rem;
      }
      .result {
          font-size: 1.3rem;
      }
    }
  </style>
</head>
<body>
  <h1>🥢 윤이의 메뉴 결정🍻</h1>
  <div class="tree" id="tree">
    <div class="node">❓ 술을 먹을 것인가?
      <div class="branch visible"> <div class="node choice-node" id="choice-yes">🍶 <strong>Yes!</strong> 술을 먹는다
          <div class="branch">
            <div class="node">🍶 소주
              <div class="branch">
                <div class="node">삼겹살 🥩</div>
                <div class="node">감자탕 🍲</div>
                <div class="node">회 🐟</div>
              </div>
            </div>
            <div class="node">🍺 맥주
              <div class="branch">
                <div class="node">치킨 🍗</div>
                <div class="node">피자 🍕</div>
                <div class="node">감바스 🍤</div>
              </div>
            </div>
            <div class="node">🍷 와인
              <div class="branch">
                <div class="node">치즈 🧀</div>
                <div class="node">파스타 🍝</div>
                <div class="node">스테이크 🥩</div>
              </div>
            </div>
            <div class="node">🍶 막걸리
              <div class="branch">
                <div class="node">파전 🥬</div>
                <div class="node">도토리묵 🌰</div>
                <div class="node">전골 🍲</div>
              </div>
            </div>
            <div class="node">🍹 칵테일
              <div class="branch">
                <div class="node">나쵸 🌮</div>
                <div class="node">타파스 🧆</div>
                <div class="node">해산물 🦐</div>
              </div>
            </div>
            <div class="node">🍶 고량주
              <div class="branch">
                <div class="node">훠궈 🔥</div>
                <div class="node">양꼬치 🍢</div>
                <div class="node">마라샹궈 🌶️</div>
              </div>
            </div>
          </div>
        </div>
        <div class="node choice-node" id="choice-no">🚫 <strong>No!</strong> 술 안 먹는다
          <div class="branch">
            <div class="node">🍚 한식
              <div class="branch">
                <div class="node">국밥 🍲</div>
                <div class="node">제육볶음 🐖</div>
                <div class="node">비빔밥 🥗</div>
              </div>
            </div>
            <div class="node">🥡 중식
              <div class="branch">
                <div class="node">짜장면 🍜</div>
                <div class="node">탕수육 🍖</div>
                <div class="node">마라탕 🌶️</div>
              </div>
            </div>
            <div class="node">🍣 일식
              <div class="branch">
                <div class="node">돈카츠 🐷</div>
                <div class="node">초밥 🍣</div>
                <div class="node">우동 🍜</div>
              </div>
            </div>
            <div class="node">🍝 양식
              <div class="branch">
                <div class="node">파스타 🍝</div>
                <div class="node">리조또 🧄</div>
                <div class="node">스테이크 🥩</div>
              </div>
            </div>
            <div class="node">🍢 분식
              <div class="branch">
                <div class="node">떡볶이 🌶️</div>
                <div class="node">순대 🐷</div>
                <div class="node">김밥 🍙</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <button class="action-button hidden" id="start-selection-button">✨ 메뉴 결정 시작!</button>
  <div class="result" id="result"></div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const choiceYes = document.getElementById('choice-yes');
      const choiceNo = document.getElementById('choice-no');
      const startButton = document.getElementById('start-selection-button');
      const resultDiv = document.getElementById('result');
      let selectionStartNode = null;

      function makeChoice(selectedNode, unselectedNode) {
        // 선택한 노드를 강조하고 다른 노드는 비활성화
        selectedNode.classList.add('selected');
        unselectedNode.classList.add('unselected');
        
        // 상위 선택 노드들의 클릭 이벤트를 비활성화
        choiceYes.style.pointerEvents = 'none';
        choiceNo.style.pointerEvents = 'none';

        // 선택한 노드의 하위 브랜치를 표시
        const selectedBranch = selectedNode.querySelector(':scope > .branch');
        if (selectedBranch) {
            selectedBranch.classList.add('visible');
        }

        // 최종 선택 시작 노드로 설정
        selectionStartNode = selectedNode;

        // 최종 선택 버튼을 표시
        startButton.classList.remove('hidden');
        const choiceText = selectedNode.textContent.trim().startsWith('Yes') ? '술과 안주' : '메뉴';
        startButton.textContent = `✨ 오늘의 ${choiceText} 결정!`;
      }

      // 각 선택지에 클릭 이벤트 리스너 추가 (한 번만 실행)
      choiceYes.addEventListener('click', () => makeChoice(choiceYes, choiceNo), { once: true });
      choiceNo.addEventListener('click', () => makeChoice(choiceNo, choiceYes), { once: true });
      
      // 메뉴 결정 시작 버튼 클릭 이벤트
      startButton.addEventListener('click', () => {
        if (!selectionStartNode) return;

        // 이전 결과와 하이라이트 초기화
        resultDiv.textContent = '';
        document.querySelectorAll('.node.highlight').forEach(n => n.classList.remove('highlight'));
        startButton.classList.add('hidden'); // 버튼 숨기기

        simulateStepByStep(selectionStartNode);
      });

      function simulateStepByStep(startNode) {
        let current = startNode;
        const path = [current];

        // startNode부터 시작하여 최종 메뉴까지의 경로를 무작위로 결정
        while (true) {
          const branch = current.querySelector(':scope > .branch');
          if (!branch) break; // 자식 브랜치가 없으면(최종 메뉴) 중지

          // 현재 단계의 선택지들이 보이도록 브랜치를 표시
          branch.classList.add('visible');

          const children = Array.from(branch.children).filter(c => c.classList.contains('node'));
          if (children.length === 0) break; // 브랜치에 노드가 없으면 중지

          // 다음 단계 노드를 무작위로 선택
          const next = children[Math.floor(Math.random() * children.length)];
          path.push(next);
          current = next;
        }

        // 결정된 경로를 따라 순차적으로 하이라이트 애니메이션 실행
        let idx = 0;
        const interval = setInterval(() => {
          // 이전 단계의 하이라이트 제거 (첫 선택지는 유지)
          if (idx > 0 && path[idx - 1] !== selectionStartNode) {
            path[idx - 1].classList.remove('highlight');
          }

          // 현재 단계 노드 하이라이트
          if (idx < path.length) {
            path[idx].classList.add('highlight');
            idx++;
          } else {
            clearInterval(interval);
            // 최종 선택된 메뉴를 강조하고 결과 텍스트 표시
            const finalChoice = path[path.length - 1];
            finalChoice.classList.add('highlight');
            resultDiv.innerHTML = `🎉 오늘은... <strong>${finalChoice.textContent.trim()}</strong>! 🎉`;
          }
        }, 700); // 애니메이션 간격
      }
    });
  </script>
</body>
</html>
